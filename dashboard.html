<!DOCTYPE html>
<html lang="en">
<head>
  <!-- ‚úÖ Basic Meta -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>EANO Dashboard</title>
  <meta name="description" content="EANO Network - Decentralized Community Mining Platform like Pi Network" />
  <meta name="keywords" content="EANO, crypto, mining, Pi Network, blockchain, community" />
  <meta name="author" content="Santus EANO Team" />
  <meta name="theme-color" content="#121212" />

  <!-- ‚úÖ Open Graph (Facebook, LinkedIn, etc.) -->
  <meta property="og:title" content="EANO Dashboard" />
  <meta property="og:description" content="Mine EANO daily and grow your trust score in the decentralized network." />
  <meta property="og:image" content="https://eano-santus.github.io/eano-coin/logo.png" />
  <meta property="og:url" content="https://eano-santus.github.io/eano-coin/dashboard.html" />
  <meta property="og:type" content="website" />

  <!-- ‚úÖ Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="EANO Dashboard" />
  <meta name="twitter:description" content="Earn EANO daily, refer users, and join the decentralized revolution." />
  <meta name="twitter:image" content="https://eano-santus.github.io/eano-coin/logo.png" />

  <!-- ‚úÖ PWA Manifest -->
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="favicon.ico" />
  <link rel="apple-touch-icon" href="icons/icon-192x192.png" />

  <!-- ‚úÖ Styles -->
  <link rel="stylesheet" href="style.css" />
</head>
<body class="dark-mode">

  <!-- ... Everything from previous version (Balance, Menu, Mine button, etc.) ... -->

  <!-- üîµ Fixed Mine Button -->
  <button id="mineBtn" class="mine-button">üîµ</button>

  <!-- ‚úÖ Footer -->
  <footer class="footer">
    <p>¬© 2025 EANO Network ‚Ä¢ Built by Santus with ‚ù§Ô∏è</p>
    <p><a href="https://t.me/eano_support" target="_blank">Support</a> | <a href="whitepaper.html">Whitepaper</a></p>
  </footer>

  <!-- ‚úÖ Inject API Key -->
  <script>
    window.FIREBASE_API_KEY = "{{ FIREBASE_API_KEY }}";
  </script>

  <!-- ‚úÖ Firebase Module -->
  <script type="module" src="firebase.js"></script>

  <!-- ‚úÖ Dashboard Logic -->
  <script>
    // Light/Dark Mode
    document.getElementById("toggleTheme").onclick = function () {
      document.body.classList.toggle("light-mode");
    };

    // Logout
    document.getElementById("logoutBtn").onclick = function () {
      localStorage.clear();
      window.location.href = "index.html";
    };

    // Countdown & Mining
    function startCountdown(duration) {
      const countdownEl = document.getElementById("countdown");
      let remaining = duration;
      const interval = setInterval(() => {
        const hours = String(Math.floor(remaining / 3600)).padStart(2, '0');
        const mins = String(Math.floor((remaining % 3600) / 60)).padStart(2, '0');
        const secs = String(remaining % 60).padStart(2, '0');
        countdownEl.textContent = `${hours}:${mins}:${secs}`;
        if (--remaining < 0) clearInterval(interval);
      }, 1000);
    }

    async function startMining() {
      const start = localStorage.getItem("mineStart");
      const now = Date.now();
      const sessionDuration = 24 * 60 * 60 * 1000;

      if (!start || now - parseInt(start) >= sessionDuration) {
        localStorage.setItem("mineStart", now);
      }

      const sessionEnd = parseInt(localStorage.getItem("mineStart")) + sessionDuration;
      const remainingSecs = Math.floor((sessionEnd - now) / 1000);
      startCountdown(remainingSecs);

      const balanceEl = document.getElementById("balance");
      let balance = parseFloat(localStorage.getItem("balance") || "0");
      const ratePerSecond = 0.600 / 3600;

      const miner = setInterval(() => {
        if (Date.now() >= sessionEnd) {
          clearInterval(miner);
          return;
        }
        balance += ratePerSecond;
        balanceEl.textContent = balance.toFixed(3);
        localStorage.setItem("balance", balance.toFixed(3));
      }, 1000);
    }

    window.onload = () => {
      startMining();
      registerServiceWorker();
    };

    // ‚úÖ Register PWA Service Worker
    function registerServiceWorker() {
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('service-worker.js')
          .then(() => console.log("‚úÖ Service Worker Registered"))
          .catch(err => console.error("‚ùå Service Worker Failed:", err));
      }
    }
  </script>
</body>
</html>
