<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>EANO Card Game</title>
  <link rel="preload" as="image" href="assets/avatar11.png">
  <link rel="preload" as="image" href="assets/avatar12.png">
  <link rel="preload" as="image" href="assets/crypto_male.png">
  <link rel="preload" as="image" href="assets/crypto_female.png">
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: sans-serif;
      background: #111;
      color: white;
    }

    .screen {
      display: none;
      height: 100vh;
      width: 100vw;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }

    .screen.show {
      display: flex;
    }

    .avatar-selection img {
      height: 100px;
      margin: 10px;
      border: 3px solid transparent;
      border-radius: 50%;
      cursor: pointer;
      transition: 0.3s;
    }

    .avatar-selection img:hover {
      border: 3px solid #4fc3f7;
    }

    .avatar-img {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      animation: idleFloat 3s ease-in-out infinite;
    }

    @keyframes idleFloat {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-6px); }
    }

    .talking {
      animation: pulseTalk 0.3s ease-in-out 3;
    }

    @keyframes pulseTalk {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    .bubble {
      margin-top: 5px;
      background: #333;
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 14px;
    }

    .game-board {
      display: flex;
      flex-direction: column;
      align-items: center;
      height: 100vh;
      width: 100vw;
      padding: 10px;
    }

    .avatars {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 90%;
      padding: 10px;
    }

    .avatar-box {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 10px;
    }

    .table {
      flex: 1;
      width: 90%;
      max-width: 650px;
      border: 2px solid #4fc3f7;
      border-radius: 20px;
      margin: 10px 0;
      background: #222;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .hand {
      overflow-x: auto;
      display: flex;
      padding: 10px;
      justify-content: center;
    }

    .hand::-webkit-scrollbar {
      height: 8px;
    }

    .hand::-webkit-scrollbar-thumb {
      background: #4fc3f7;
      border-radius: 10px;
    }

    .hand .card {
      cursor: pointer;
    }

    .card {
      background: #1e1e2f;
      border: 2px solid #4fc3f7;
      padding: 10px;
      border-radius: 10px;
      margin: 5px;
      font-size: 13px;
      text-align: center;
      font-weight: bold;
      min-width: 60px;
    }

    .play-area {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 10px;
    }

    .market-container {
      text-align: center;
      margin: 10px auto;
    }

    .market-container button {
      background: #4caf50;
      color: white;
      padding: 10px 16px;
      font-size: 16px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      box-shadow: 0 0 10px #4caf50;
    }
  </style>
</head>
<body>

<!-- Avatar Selection -->
<div id="avatar-screen" class="screen show">
  <h2>Select Your Avatar</h2>
  <div class="avatar-selection">
    <img src="assets/avatar11.png" onclick="selectAvatar('assets/avatar11.png')">
    <img src="assets/avatar12.png" onclick="selectAvatar('assets/avatar12.png')">
    <img src="assets/crypto_male.png" onclick="selectAvatar('assets/crypto_male.png')">
    <img src="assets/crypto_female.png" onclick="selectAvatar('assets/crypto_female.png')">
  </div>
</div>

<!-- Game Screen -->
<div id="game-screen" class="screen">
  <div class="game-board">
    <div class="avatar-box">
      <img id="aiAvatar" class="avatar-img" alt="AI Avatar">
      <div class="bubble" id="aiBubble">Ready?</div>
    </div>

    <div class="avatar-box">
      <img id="playerAvatar" class="avatar-img" alt="Player Avatar">
      <div class="bubble" id="playerBubble">Your move</div>
    </div>

    <div class="table">
      <div class="hand" id="aiHand"></div>
      <div class="play-area">
        <div class="card" id="playCard">Start</div>
      </div>
      <div class="hand" id="playerHand"></div>
      <div class="market-container">
        <button id="marketBtn" onclick="useMarket()">ğŸ›’ Market (Draw)</button>
      </div>
    </div>
  </div>
</div>

<script>
const playerHand = document.getElementById("playerHand");
const playCard = document.getElementById("playCard");
const aiBubble = document.getElementById("aiBubble");
const playerBubble = document.getElementById("playerBubble");
const aiHand = document.getElementById("aiHand");
const playerAvatar = document.getElementById("playerAvatar");

const playerCards = [];
const aiCards = [];
const cardNames = [
  "TrustScore ğŸ–", "Studio ğŸ™", "Community ğŸ«‚", "Mainnet ğŸŒ",
  "Marketplace ğŸ›", "Pick 2 ğŸ”", "Hold On â©", "Suspension ğŸ›‘"
];

const aiEmotes = ["Hmm...", "Nice move!", "Oh no!", "You got me!", "Play fast ğŸ˜ˆ"];
let isPlayerTurn = true;
let currentCard;
let marketUsed = false;

const aiAvatars = [
  'assets/avatar11.png',
  'assets/avatar12.png',
  'assets/crypto_male.png',
  'assets/crypto_female.png'
];

function selectAvatar(src) {
  document.getElementById("avatar-screen").classList.remove("show");
  document.getElementById("game-screen").classList.add("show");
  playerAvatar.src = src;
  initGame();
}

function initGame() {
  const aiAvatar = aiAvatars[Math.floor(Math.random() * aiAvatars.length)];
  document.getElementById("aiAvatar").src = aiAvatar;

  for (let i = 0; i < 4; i++) {
    playerCards.push(drawCard());
    aiCards.push(drawCard());
  }

  currentCard = drawCard();
  playCard.innerText = `${currentCard.name}\n${currentCard.number}`;
  renderHand();
  playerBubble.innerText = "Game started";
  aiBubble.innerText = "Let's go!";
}

function drawCard() {
  return {
    name: cardNames[Math.floor(Math.random() * cardNames.length)],
    number: Math.floor(Math.random() * 14) + 1
  };
}

function renderHand() {
  playerHand.innerHTML = '';
  playerCards.forEach((card, index) => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerText = `${card.name}\n${card.number}`;
    div.onclick = () => playPlayerCard(index);
    playerHand.appendChild(div);
  });

  aiHand.innerHTML = '';
  aiCards.forEach(() => {
    const cardBack = document.createElement("div");
    cardBack.className = "card";
    cardBack.innerText = "ğŸ‚ ";
    aiHand.appendChild(cardBack);
  });
}

function playPlayerCard(index) {
  if (!isPlayerTurn) return;
  const card = playerCards[index];
  const valid = card.name === currentCard.name || card.number === currentCard.number ||
    ["Pick 2 ğŸ”", "Suspension ğŸ›‘", "Hold On â©"].includes(card.name);

  if (valid) {
    currentCard = card;
    playCard.innerText = `${card.name}\n${card.number}`;
    playerCards.splice(index, 1);
    playerBubble.innerText = `You played ${card.name}`;
    renderHand();

    if (card.name === "Pick 2 ğŸ”") {
      aiCards.push(drawCard(), drawCard());
      aiBubble.innerText = "ğŸ˜  Picked 2!";
    } else if (card.name === "Suspension ğŸ›‘") {
      aiBubble.innerText = "ğŸ˜‘ Skipped!";
      checkWin();
      return setTimeout(() => {
        isPlayerTurn = true;
        playerBubble.innerText = "Go again!";
      }, 1000);
    } else if (card.name === "Hold On â©") {
      playerBubble.innerText = "Another turn ğŸ”";
      checkWin();
      return;
    }

    isPlayerTurn = false;
    marketUsed = false;
    checkWin();
    setTimeout(aiTurn, 1000);
  } else {
    playerBubble.innerText = "âŒ Invalid move";
  }
}

function aiSpeak(message) {
  aiBubble.innerText = message;
  const aiImg = document.getElementById("aiAvatar");
  aiImg.classList.add("talking");
  setTimeout(() => aiImg.classList.remove("talking"), 1200);
}

function aiTurn() {
  const playableIndex = aiCards.findIndex(c =>
    c.name === currentCard.name || c.number === currentCard.number ||
    ["Pick 2 ğŸ”", "Hold On â©", "Suspension ğŸ›‘"].includes(c.name)
  );

  if (playableIndex !== -1) {
    const card = aiCards[playableIndex];
    aiCards.splice(playableIndex, 1);
    currentCard = card;
    playCard.innerText = `${card.name}\n${card.number}`;
    aiSpeak(aiEmotes[Math.floor(Math.random() * aiEmotes.length)]);
    renderHand();

    if (card.name === "Pick 2 ğŸ”") {
      playerCards.push(drawCard(), drawCard());
      playerBubble.innerText = "Picked 2 ğŸ˜­";
    } else if (card.name === "Suspension ğŸ›‘") {
      playerBubble.innerText = "â­ Skipped!";
      checkWin();
      return setTimeout(aiTurn, 1000);
    } else if (card.name === "Hold On â©") {
      aiBubble.innerText = "Another turn ğŸŒ€";
      checkWin();
      return setTimeout(aiTurn, 1000);
    }

    setTimeout(() => {
      isPlayerTurn = true;
      playerBubble.innerText = "Your move";
      renderHand();
      checkWin();
    }, 1000);
  } else {
    aiBubble.innerText = "ğŸ¤· No card to play";
    aiCards.push(drawCard());
    renderHand();
    setTimeout(() => {
      isPlayerTurn = true;
      playerBubble.innerText = "Your move";
    }, 1000);
  }
}

function checkWin() {
  if (playerCards.length === 0) {
    setTimeout(() => {
      alert("ğŸ‰ You Win!");
      location.reload();
    }, 500);
  } else if (aiCards.length === 0) {
    setTimeout(() => {
      alert("ğŸ’€ Eano AI Wins!");
      location.reload();
    }, 500);
  }
}

function useMarket() {
  if (!isPlayerTurn || marketUsed) {
    playerBubble.innerText = "ğŸš« You can't draw now!";
    return;
  }
  const newCard = drawCard();
  playerCards.push(newCard);
  marketUsed = true;
  playerBubble.innerText = `ğŸ›’ Drew a card`;
  renderHand();
}
</script>
</body>
  </html>
