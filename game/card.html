<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="UTF-8" />
  <title>EANO Card Game</title>
  <link rel="preload" as="image" href="assets/avatar11.png">
  <link rel="preload" as="image" href="assets/avatar12.png">
  <link rel="preload" as="image" href="assets/crypto_male.png">
  <link rel="preload" as="image" href="assets/crypto_female.png">
  <style>
  * {
    box-sizing: border-box;
  }

  body, html {
    height: 100%;
    margin: 0;
    padding: 0;
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(to bottom right, #0d1524, #1a1f38);
    color: white;
    overflow-x: hidden;
  }

  .screen {
    display: none;
    min-height: 100vh;
    width: 100vw;
    align-items: center;
    justify-content: center;
    flex-direction: column;
  }

  .screen.show {
    display: flex;
  }

  .avatar-selection img {
    height: 80px;
    margin: 15px;
    border: 3px solid transparent;
    border-radius: 50%;
    cursor: pointer;
    transition: 0.3s;
  }

  .avatar-selection img:hover {
    border: 3px solid #4fc3f7;
  }

  .avatar-img {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    animation: idleFloat 3s ease-in-out infinite;
    border: 2px solid #4fc3f7;
    object-fit: cover;
    background-color: #111;
  }

  @keyframes idleFloat {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-6px); }
  }

  .talking {
    animation: pulseTalk 0.3s ease-in-out 3;
  }

  @keyframes pulseTalk {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
  }

  .bubble {
    margin-top: 5px;
    background: #333;
    padding: 5px 10px;
    border-radius: 20px;
    font-size: 14px;
    max-width: 100px;
    text-align: center;
  }

  .game-board {
    width: 100%;
    max-width: 650px;
    margin: auto;
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .avatars {
    display: flex;
    justify-content: space-around;
    align-items: center;
    width: 100%;
    padding: 10px;
  }

  .avatar-box {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .table {
    flex: 1;
    width: 100%;
    border: 2px solid #4fc3f7;
    border-radius: 20px;
    background: #222;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 10px;
    box-shadow: 0 0 10px #00d0ff66;
  }

  .hand {
    overflow-x: auto;
    display: flex;
    padding: 10px;
    justify-content: center;
  }

  .hand::-webkit-scrollbar {
    height: 8px;
  }

  .hand::-webkit-scrollbar-thumb {
    background: #4fc3f7;
    border-radius: 10px;
  }

  .card {
    background: #1e1e2f;
    border: 2px solid #4fc3f7;
    padding: 10px;
    border-radius: 10px;
    margin: 5px;
    font-size: 13px;
    text-align: center;
    font-weight: bold;
    min-width: 80px;
    color: #fff;
    box-shadow: 0 0 5px #4fc3f7aa;
  }

  .card:hover {
    transform: scale(1.05);
    background: #273043;
  }

  .play-area {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 10px;
  }

  .market-container {
    text-align: center;
    margin: 10px auto;
  }

  .market-container button {
    background: #4caf50;
    color: white;
    padding: 12px 20px;
    font-size: 16px;
    border-radius: 25px;
    border: none;
    cursor: pointer;
    box-shadow: 0 0 10px #4caf50;
    transition: all 0.2s;
  }

  .market-container button:hover {
    background: #45a049;
    box-shadow: 0 0 15px #4caf50;
  }

  h2 {
    text-align: center;
    color: #4fc3f7;
    margin-bottom: 20px;
  }
</style>
</head>
    <audio id="sfx-pick" src="sounds/pick2.mp3"></audio>
<audio id="sfx-suspend" src="sounds/suspend.mp3"></audio>
<audio id="sfx-hold" src="sounds/holdon.mp3"></audio>
<audio id="sfx-market" src="sounds/market.mp3"></audio>
<body>

<!-- Avatar Selection -->
<div id="avatar-screen" class="screen show">
  <h2>Select Your Avatar</h2>
  <div class="avatar-selection">
    <img src="assets/avatar11.png" onclick="selectAvatar('assets/avatar11.png')">
    <img src="assets/avatar12.png" onclick="selectAvatar('assets/avatar12.png')">
    <img src="assets/crypto_male.png" onclick="selectAvatar('assets/crypto_male.png')">
    <img src="assets/crypto_female.png" onclick="selectAvatar('assets/crypto_female.png')">
  </div>
</div>

<!-- Game Screen -->
<div id="game-screen" class="screen">
  <div class="game-board">
    <div class="avatars">
  <div class="avatar-box">
    <img id="aiAvatar" class="avatar-img" alt="AI Avatar" src="">
    <div class="bubble" id="aiBubble">Ready?</div>
  </div>

  <div class="avatar-box">
    <img id="playerAvatar" class="avatar-img" alt="Player Avatar" src="">
    <div class="bubble" id="playerBubble">Your move</div>
  </div>
    </div>

    <div class="table">
      <div class="hand" id="aiHand"></div>
      <div class="play-area">
        <div class="card" id="playCard">Start</div>
      </div>
      <div class="hand" id="playerHand"></div>
      <div class="market-container">
        <button id="marketBtn" onclick="useMarket()">🛒 Market (Draw)</button>
      </div>
    </div>
  </div>
</div>

<script>
const playerHand = document.getElementById("playerHand");
const playCard = document.getElementById("playCard");
const aiBubble = document.getElementById("aiBubble");
const playerBubble = document.getElementById("playerBubble");
const aiHand = document.getElementById("aiHand");
const playerAvatar = document.getElementById("playerAvatar");

const playerCards = [];
const aiCards = [];
const cardNames = [
  "TrustScore 🎖", "Studio 🎙", "Community 🫂", "Mainnet 🌐",
  "Marketplace 🛍", "Pick 2 🔁", "Hold On ⏩", "Suspension 🛑"
];
const specialCardNumbers = {
  1: "Hold On ⏩",
  2: "Pick 2 🔁",
  8: "Suspension 🛑",
  14: "Market 🎲"
};
const aiEmotes = ["Hmm...", "Nice move!", "Oh no!", "You got me!", "Play fast 😈"];
let isPlayerTurn = true;
let currentCard;
let marketUsed = false;

const aiAvatars = [
  'assets/avatar11.png',
  'assets/avatar12.png',
  'assets/crypto_male.png',
  'assets/crypto_female.png'
];

function selectAvatar(src) {
  document.getElementById("avatar-screen").classList.remove("show");
  document.getElementById("game-screen").classList.add("show");
  playerAvatar.src = src;
  initGame();
}
    
function playSound(type) {
  const sounds = {
    pick: document.getElementById("sfx-pick"),
    suspend: document.getElementById("sfx-suspend"),
    hold: document.getElementById("sfx-hold"),
    market: document.getElementById("sfx-market")
  };
  sounds[type]?.play();
      }
    
function initGame() {
  const aiAvatar = aiAvatars[Math.floor(Math.random() * aiAvatars.length)];
  document.getElementById("aiAvatar").src = aiAvatar;

  for (let i = 0; i < 4; i++) {
    playerCards.push(drawCard());
    aiCards.push(drawCard());
  }

  currentCard = drawCard();
  playCard.innerText = `${currentCard.name}\n${currentCard.number}`;
  renderHand();
  playerBubble.innerText = "Game started";
  aiBubble.innerText = "Let's go!";
}

function drawCard() {
  return {
    name: cardNames[Math.floor(Math.random() * cardNames.length)],
    number: Math.floor(Math.random() * 14) + 1
  };
}

function renderHand() {
  playerHand.innerHTML = '';
  playerCards.forEach((card, index) => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerText = `${card.name}\n${card.number}${specialCardNumbers[card.number] ? '\n' + specialCardNumbers[card.number] : ''}`;
    div.onclick = () => playPlayerCard(index);
    playerHand.appendChild(div);
  });

  aiHand.innerHTML = '';
  aiCards.forEach(() => {
    const cardBack = document.createElement("div");
    cardBack.className = "card";
    cardBack.innerText = "🂠";
    aiHand.appendChild(cardBack);
  });
}

function playPlayerCard(index) {
  if (!isPlayerTurn) return;
  const card = playerCards[index];
  const valid = card.name === currentCard.name || card.number === currentCard.number;

// Card effects by number
if (card.number === 2) {
  aiCards.push(drawCard(), drawCard());
  aiBubble.innerText = "😠 Picked 2!";
  playSound("pick");
} else if (card.number === 8) {
  aiBubble.innerText = "😑 Skipped!";
  playSound("suspend");
  renderHand();
  checkWin();
  return setTimeout(() => {
    isPlayerTurn = true;
    playerBubble.innerText = "Go again!";
  }, 1000);
} else if (card.number === 1) {
  playerBubble.innerText = "Another turn 🔁";
  playSound("hold");
  renderHand();
  checkWin();
  return; // Player keeps turn
} else if (card.number === 14) {
  playerBubble.innerText = "Market for all 🎲";
  aiCards.push(drawCard());
  playerCards.push(drawCard());
  playSound("market");
}

currentCard = card;
playerCards.splice(index, 1);
renderHand();
isPlayerTurn = false;
marketUsed = false;
checkWin();
setTimeout(aiTurn, 1000);
    }

    isPlayerTurn = false;
    marketUsed = false;
    checkWin();
    setTimeout(aiTurn, 1000);
  } else {
    playerBubble.innerText = "❌ Invalid move";
  }
}

function aiSpeak(message) {
  aiBubble.innerText = message;
  const aiImg = document.getElementById("aiAvatar");
  aiImg.classList.add("talking");
  setTimeout(() => aiImg.classList.remove("talking"), 1200);
}

function aiTurn() {
  const playableIndex = aiCards.findIndex(c =>
    c.name === currentCard.name || c.number === currentCard.number ||
    ["Pick 2 🔁", "Hold On ⏩", "Suspension 🛑"].includes(c.name)
  );

  if (playableIndex !== -1) {
    const card = aiCards[playableIndex];
    aiCards.splice(playableIndex, 1);
    currentCard = card;
    playCard.innerText = `${card.name}\n${card.number}`;
    aiSpeak(aiEmotes[Math.floor(Math.random() * aiEmotes.length)]);
    renderHand();

    if (card.number === 2) {
  playerCards.push(drawCard(), drawCard());
  playerBubble.innerText = "Picked 2 😭";
  playSound("pick");
} else if (card.number === 8) {
  playerBubble.innerText = "⏭ Skipped!";
  playSound("suspend");
  renderHand();
  checkWin();
  return setTimeout(aiTurn, 1000);
} else if (card.number === 1) {
  aiBubble.innerText = "Another turn 🌀";
  playSound("hold");
  renderHand();
  checkWin();
  return setTimeout(aiTurn, 1000);
} else if (card.number === 14) {
  aiBubble.innerText = "Market for both 🎲";
  playerCards.push(drawCard());
  aiCards.push(drawCard());
  playSound("market");
    }

    setTimeout(() => {
      isPlayerTurn = true;
      playerBubble.innerText = "Your move";
      renderHand();
      checkWin();
    }, 1000);
  } else {
    aiBubble.innerText = "🤷 No card to play";
    aiCards.push(drawCard());
    renderHand();
    setTimeout(() => {
      isPlayerTurn = true;
      playerBubble.innerText = "Your move";
    }, 1000);
  }
}

function checkWin() {
  if (playerCards.length === 0) {
    setTimeout(() => {
      alert("🎉 You Win!");
      location.reload();
    }, 500);
  } else if (aiCards.length === 0) {
    setTimeout(() => {
      alert("💀 Eano AI Wins!");
      location.reload();
    }, 500);
  }
}

function useMarket() {
  if (!isPlayerTurn || marketUsed) {
    playerBubble.innerText = "🚫 You can't draw now!";
    return;
  }
  const newCard = drawCard();
  playerCards.push(newCard);
  marketUsed = true;
  playerBubble.innerText = `🛒 Drew a card`;
  renderHand();
}
</script>
</body>
</html>
